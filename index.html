<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="title">Music Algorythm</title>

<style>
        .center {
            margin: auto;
            width: 200px;
        }
        .right {
          margin-left: auto; 
          margin-right: 0;
          float: right;
         }
    </style> 
   </head>


<body>
<div id="search">
     <br>
     <center><label for="input" style="color:Black; width: 500px">Enter Channel Link or Handle</label>
       <br>

    <label> <input id="query" value='' placeholder='@larryhill212official' type="text"/><button id="search-button"    onclick="keyWordsearch()">Search</button></label>    
    <div id="resultcontainer" style="display:none">
    <h1>Result</h1>
    <ul id="results"></ul>
    </div>
</div>
<div id="artistinfo" style="display:none">

<div id="artistembed" class="right">
<img id="artistthumb" src="https://yt3.ggpht.com/_8mJJ-tyTXrl88c7Fp4H6FDKXIwoSw03cpvu8-3o0Ao-tqPZxetR_QZjaTxBcTNU3ScRdjPeKRw=s88-c-k-c0xffffffff-no-rj-mo" alt="No  Image  Available." style="width:356;height:356px">
<h2 id="artistname" class="center">Wu-Tang Clan</h2>
</div>

<h1>Public Playlists</h1>
  <form id="artistplaylists">
  <input type="checkbox" id="playlist-1">
  <label for="playlist-1">loading playlists..</label><br>
</form>
</div>
      
<script>
 function keyWordsearch(){
    gapi.client.setApiKey(atob("QUl6YVN5Qnc3SUVXbUttSnFfLTdWbk9pSTEwXzdEN25qZEVjelBv"));
    gapi.client.load('youtube', 'v3', function(){
            makeRequest();
    });
}
function makeRequest(){
    document.getElementById("resultcontainer").style.display = 'block'
    var q = $('#query').val();
    var isHandle = q.includes("@")
    if (q == "") { q = "@larryhill212official"; }
    if(q.includes("/channel/")) { q = q.split("/channel/")[1] ;}
    if(q.includes("@")) { q = q.split("@")[1]; }
    if(q.includes("/")) { q = q.split("/")[0]; }
    var request = null
    if (!isHandle) { 
    request = gapi.client.youtube.channel.list({
            part: 'snippet',
            id: q
    }); } else {
    request = gapi.client.youtube.channel.list({
            part: 'snippet',
            forHandle: q
    });}
    request.execute(function(response)  {                                                                                
            $('#results').empty()
            var srchItems = response.result.items;
            var i = 0                      
            $.each(srchItems, function(index, item){
            console.log(item)
            vidId = item.snippet.channelId;
            vidTitle = item.snippet.title;  
            vidThumburl =  item.snippet.thumbnails.high.url;                 
            vidThumbimg = '<pre><img id="thumb" src="'+vidThumburl+'" alt="No  Image  Available." style="width:256px;height:256px"></pre>';                   
            var button = '<button id="submitbutton"  onclick="submitArtist(`' + vidTitle + '`, `' + vidId + '`, `' + vidThumburl + '`)">Select</button>'
            $('#results').append('<pre>' + vidThumbimg + "<b><h3>" + vidTitle + '</b></h3>' + button + '</pre>');  
            i++;  
    })  
  })  
}

function submitArtist(name, id, img) {
  document.getElementById("results").innerHTML = "";
  document.getElementById("search").style.display = "none";
  document.getElementById("artistinfo").style.display = "block";
  document.getElementById("artistthumb").src = img;
  if (name.includes(" - Topic")) { name = name.split(" - Topic")[0]; }
  document.getElementById("artistname").innerHTML = name;
 
  var request = gapi.client.youtube.playlists.list({
            part: 'snippet, status',
            channelId: id
    }); 
  var playlists = []
    request.execute(function(response2)  {                                                                                
            //$('#results').empty()
            var srchItems = response2.result.items;
            console.log(srchItems)
            $.each(srchItems, function(index, item){ 
           console.log(item)  
          if (item.snippet.title != "") {playlists.push(item);}
    })
    })

   updatePlaylists(playlists, true)  
}

function updatePlaylists(playlists, wipe = false) {
     if (wipe) {document.getElementById("artistplaylists").innerHTML = "";}
     for(j = 0; j < playlists.length; j++) {
       var playlist= document.createElement('input')
       playlist.type = "checkbox"
       playlist.id = "playlist-" + j
       playlist.name = playlists[j].id
       var playlistLabel = document.createElement('label')
       playlistLabel.for = playlist.id
       playlistLabel.textContent = playlists[j].snippet.title
       playlistLabel.innerHTML += "<br>";
       document.getElementById("playlists").appendChild(playlist)
       document.getElementById("playlists").appendChild(playlistLabel)
     }
     if(playlists.length < 1) {document.getElementById("artistplaylists").innerHTML = "No public playlists found, keep in mind that Albums/Releases are not detected here. You will have to add them manually.";}
    
  }


 </script> 
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
 <script src="https://apis.google.com/js/client.js?onload=googleApiClientReady">   </script>


</body>
</html>
